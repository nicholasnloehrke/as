# RISC Assembler

## Usage

`as.py <infile>`

`as.py <infile> -o <outfile>`

### Example

```
# cat main.s
start:
        li   D1, 5
        li   D2, 7
        add  D3, D1, D2
        jal  func
        lw   D3, data
        j    end

func:
        push D1
        push D2

        li   D1, 3
        li   D3, 2

        sub  D2, D1, D3
        sw   D2, data

        pop D2
        pop D1
        jr

data:
        j   data # we don't actually want to jump, this is just
                 # to reserve memory

end:
        j   end
# ./as.py main.s -o ram.mif
# cat ram.mif
-- Auto generated by https://github.com/nicholasnloehrke/as

WIDTH=11;
DEPTH=32;

ADDRESS_RADIX=UNS;
DATA_RADIX=BIN;

CONTENT BEGIN
00 : 00110100101; -- li   D1, 5
01 : 00111000111; -- li   D2, 7
02 : 00001100110; -- add  D3, D1, D2
03 : 10110000110; -- jal  6
04 : 01001101111; -- lw   D3, 15
05 : 10100010000; -- j    16
06 : 10000100000; -- push D1
07 : 10001000000; -- push D2
08 : 00110100011; -- li   D1, 3
09 : 00111100010; -- li   D3, 2
10 : 00011000111; -- sub  D2, D1, D3
11 : 01011001111; -- sw   D2, 15
12 : 10011000000; -- pop  D2
13 : 10010100000; -- pop  D1
14 : 11000000000; -- jr
15 : 10100001111; -- j    15
16 : 10100010000; -- j    16
17 : 00000000000;
18 : 00000000000;
19 : 00000000000;
20 : 00000000000;
21 : 00000000000;
22 : 00000000000;
23 : 00000000000;
24 : 00000000000;
25 : 00000000000;
26 : 00000000000;
27 : 00000000000;
28 : 00000000000;
29 : 00000000000;
30 : 00000000000;
31 : 00000000000;
END;
```

#### Error messages

Error messages are pretty ok except for non-existant labels. Those are buggy.

```
# cat main.s
li  D0, 34
# ./as.py main.s
main.s:1:10: error: value of '34' is out of range.
    1 | li  D0, 34
      |         ^~
```

```
# cat main.s
li  D5, 31
# ./as.py main.s
main.s:1:6: error: invalid token 'D5'
    1 | li  D5, 31
      |     ^~
```

```
# cat main.s
start:
        li  D0, 31
        j   oops_mispeled
loop:
        j   loop
# ./as.py main.s
main.s:0:2: error: Unknown label: 'oops_mispeled'
    0 | start:
      | ^~~~~~~~~~~~~
```
